<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>freePanes</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #0f0f0f;
        color: #fff;
        height: 100vh;
        display: flex;
        overflow: hidden;
      }

      .header {
        background: #1e1e1e;
        padding: 15px 20px;
        border-bottom: 1px solid #333;
        display: flex;
        align-items: center;
        gap: 15px;
        flex-shrink: 0;
      }

      .url-bar {
        flex: 1;
        display: flex;
        gap: 10px;
        background: #1a1a1a;
        padding: 5px;
        border-radius: 10px;
      }

      .url-input {
        flex: 1;
        padding: 10px 15px;
        background: transparent;
        border: none;
        color: #fff;
        font-size: 14px;
      }

      .url-input:focus {
        outline: none;
      }

      .btn {
        padding: 8px 16px;
        background: #4a9eff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 13px;
        cursor: pointer;
      }

      .btn:hover {
        background: #3a8eef;
      }

      .toolbar {
        background: #1a1a1a;
        padding: 10px 20px;
        display: flex;
        gap: 20px;
        align-items: center;
        border-bottom: 1px solid #2a2a2a;
        flex-shrink: 0;
      }

      .sync-controls {
        display: flex;
        gap: 15px;
      }

      .sync-option {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background: #2a2a2a;
        border-radius: 0.3rem;
        font-size: 12px;
        cursor: pointer;
        user-select: none;
      }

      .sync-option.active {
        background: #4a9eff;
      }

      .sync-option input {
        display: none; /* Hide the actual checkbox */
      }


      .viewports-container {
        flex: 1;
        padding: 20px;
        overflow-x: auto;
        overflow-y: auto;
        display: flex;
        gap: 20px;
        background: #0f0f0f;
        align-items: flex-start;
      }

      .viewport {
        background: #1a1a1a;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        flex-shrink: 0;
      }

      .viewport-header {
        background: #2a2a2a;
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #333;
      }

      .device-name {
        font-weight: 600;
        font-size: 13px;
          padding-right: 1rem;
      }

      .device-size {
        font-size: 11px;
        color: #888;
      }

      .devtools-btn {
        background: none;
        border: none;
        color: #888;
        font-size: 12px;
        cursor: pointer;
        padding: 4px 6px;
        border-radius: 4px;
        transition: all 0.2s;
        margin-left: 8px;
      }

      .devtools-btn:hover {
        background: #333;
        color: #4a9eff;
      }

      .devtools-btn.active {
        color: #4a9eff;
        background: rgba(74, 158, 255, 0.1);
      }

      .webview-container {
        position: relative;
        overflow: hidden;
        background: white;
      }

      /* Critical: Webview must be display:inline-flex to render full height */
      webview {
        background: white;
        display: inline-flex !important;
        position: absolute;
        top: 0;
        left: 0;
      }

      .device-preset {
        padding: 6px 12px;
        background: #2a2a2a;
        border: 1px solid #333;
        border-radius: 8px;
        color: #aaa;
        font-size: 12px;
        cursor: pointer;
      }

      .device-preset:hover {
        background: #333;
        color: #fff;
      }

      .device-preset.active {
        background: #4a9eff;
        color: white;
        border-color: #4a9eff;
      }

      .status-bar {
        background: #1a1a1a;
        padding: 8px 20px;
        border-top: 1px solid #2a2a2a;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 12px;
        color: #888;
        flex-shrink: 0;
      }

      .theme-toggle {
        background: transparent;
        border: none;
        color: #888;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 4px;
        transition: all 0.2s;
      }

      .theme-toggle:hover {
        background: #2a2a2a;
        color: #fff;
      }

      /* Debug mode styles */
      .debug-info {
        position: fixed;
        bottom: 50px;
        right: 20px;
        background: rgba(0,0,0,0.8);
        color: #0f0;
        padding: 10px;
        font-family: monospace;
        font-size: 11px;
        border-radius: 5px;
        max-width: 300px;
        z-index: 9999;
        display: none;
      }

      .debug-info.active {
        display: block;
      }

      /* Sidebar styles */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 280px;
        height: 100vh;
        background: #1a1a1a;
        border-right: 1px solid #2a2a2a;
        transform: translateX(-280px);
        transition: transform 0.3s ease;
        overflow-y: auto;
        z-index: 1000;
        display: flex;
        flex-direction: column;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .sidebar-header {
        padding: 15px 20px;
        background: #2a2a2a;
        border-bottom: 1px solid #333;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .sidebar-title {
        font-weight: 600;
        font-size: 14px;
      }

      .sidebar-close {
        background: none;
        border: none;
        color: #888;
        font-size: 18px;
        cursor: pointer;
        padding: 5px;
      }

      .sidebar-close:hover {
        color: #fff;
      }

      .device-list {
        padding: 15px;
      }

      .device-category {
        margin-bottom: 20px;
      }

      .category-title {
        font-size: 12px;
        color: #888;
        text-transform: uppercase;
        margin-bottom: 8px;
        font-weight: 600;
      }

      .device-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 12px;
        background: #2a2a2a;
        border-radius: 6px;
        margin-bottom: 4px;
        cursor: pointer;
        transition: all 0.2s;
      }

      .device-item:hover {
        background: #333;
      }

      .device-item.selected {
        background: #4a9eff;
      }

      .device-info {
        flex: 1;
      }

      .device-item-name {
        font-size: 13px;
        font-weight: 500;
      }

      .device-item-size {
        font-size: 11px;
        color: #aaa;
        margin-top: 2px;
      }

      .device-selected-icon {
        color: #fff;
        font-size: 12px;
        opacity: 0;
        transition: opacity 0.2s;
      }

      .device-item.selected .device-selected-icon {
        opacity: 1;
      }

      /* Main content wrapper */
      .main-content {
        width: 100%;
        display: flex;
        flex-direction: column;
        min-width: 0;
      }

      /* Dropdown styles */
      .preset-dropdown {
        position: relative;
        display: inline-block;
      }

      .preset-dropdown-toggle {
        padding: 8px 16px;
        background: #2a2a2a;
        border: 1px solid #333;
        border-radius: 8px;
        color: #fff;
        font-size: 13px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 240px;
      }

      .preset-dropdown-toggle:hover {
        background: #333;
      }

      .preset-dropdown-toggle.open {
        background: #4a9eff;
        border-color: #4a9eff;
      }

      .preset-dropdown-arrow {
        margin-left: auto;
        transition: transform 0.2s;
      }

      .preset-dropdown-toggle.open .preset-dropdown-arrow {
        transform: rotate(180deg);
      }

      .preset-dropdown-menu {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #2a2a2a;
        border: 1px solid #333;
        border-radius: 8px;
        margin-top: 4px;
        z-index: 1000;
        max-height: 300px;
        overflow-y: auto;
        display: none;
      }

      .preset-dropdown-menu.open {
        display: block;
      }

      .preset-dropdown-item {
        padding: 10px 16px;
        cursor: pointer;
        font-size: 13px;
        border-bottom: 1px solid #333;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .preset-dropdown-item:last-child {
        border-bottom: none;
      }

      .preset-dropdown-item:hover {
        background: #333;
      }

      .preset-dropdown-item.active {
        background: #4a9eff;
      }

      /* Custom preset controls */
      .custom-preset-controls {
        padding: 15px;
        border-bottom: 1px solid #333;
        background: #1e1e1e;
      }

      .custom-preset-controls.hidden {
        display: none;
      }

      .selected-devices {
        margin-top: 10px;
      }

      .selected-devices-title {
        font-size: 12px;
        color: #888;
        margin-bottom: 8px;
      }

      .selected-device-list {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .selected-device-tag {
        background: #4a9eff;
        color: white;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 11px;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .selected-device-remove {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 12px;
        padding: 0;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .selected-device-remove:hover {
        background: rgba(255,255,255,0.2);
      }

      /* Sidebar toggle button */
      .sidebar-toggle {
        position: fixed;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: #4a9eff;
        border: none;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        font-size: 16px;
        cursor: pointer;
        z-index: 1001;
        transition: left 0.3s ease;
      }

      .sidebar-toggle:hover {
        background: #3a8eef;
      }

      .sidebar.open ~ .main-content .sidebar-toggle {
        left: 290px;
      }

      /* Overlay when sidebar is open */
      .sidebar-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
      }

      .sidebar-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      /* Advanced Capture dropdown styles */
      .advanced-capture-dropdown {
        position: relative;
        display: inline-block;
      }

      .advanced-capture-toggle {
        padding: 8px 16px;
        background: #666;
        border: none;
        border-radius: 8px;
        color: white;
        font-size: 13px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .advanced-capture-toggle:hover {
        background: #777;
      }

      .advanced-capture-toggle.open {
        background: #777;
      }

      .advanced-capture-menu {
        position: absolute;
        top: 100%;
        right: 0;
        background: #2a2a2a;
        border: 1px solid #333;
        border-radius: 8px;
        margin-top: 4px;
        z-index: 1000;
        min-width: 180px;
        display: none;
      }

      .advanced-capture-menu.open {
        display: block;
      }

      .advanced-capture-item {
        padding: 10px 16px;
        cursor: pointer;
        font-size: 13px;
        border-bottom: 1px solid #333;
        color: white;
        background: none;
        border: none;
        width: 100%;
        text-align: left;
      }

      .advanced-capture-item:last-child {
        border-bottom: none;
      }

      .advanced-capture-item:hover {
        background: #333;
      }

      /* Button visibility states */
      .screenshot-controls {
        display: flex;
        gap: 10px;
        margin-left: auto;
      }

      .btn.hidden {
        display: none;
      }

      .cancel-btn {
        background: #dc3545;
      }

      .cancel-btn:hover {
        background: #c82333;
      }

      /* SVG Icon styles */
      .icon {
        width: 16px;
        height: 16px;
        fill: currentColor;
        display: inline-block;
        vertical-align: middle;
      }

      .icon-sm {
        width: 14px;
        height: 14px;
      }

      .icon-md {
        width: 18px;
        height: 18px;
      }

      .icon-lg {
        width: 20px;
        height: 20px;
      }

      /* Icon spacing */
      .btn .icon {
        margin-right: 6px;
      }

      .preset-dropdown-item .icon {
        margin-right: 8px;
      }

      .sidebar-toggle .icon {
        margin: 0;
      }

      /* Light mode styles */
      body.light-mode {
        background: #f5f5f5;
        color: #333;
      }

      body.light-mode .header {
        background: #fff;
        border-bottom-color: #e0e0e0;
      }

      body.light-mode .url-bar {
        background: #f0f0f0;
      }

      body.light-mode .url-input {
        color: #333;
      }

      body.light-mode .btn {
        background: #2196F3;
      }

      body.light-mode .btn:hover {
        background: #1976D2;
      }

      body.light-mode .toolbar {
        background: #fafafa;
        border-bottom-color: #e0e0e0;
      }

      body.light-mode .sync-option {
        background: #e8e8e8;
        color: #666;
      }

      body.light-mode .sync-option.active {
        background: #2196F3;
        color: white;
      }

      body.light-mode .viewports-container {
        background: #f5f5f5;
      }

      body.light-mode .viewport {
        background: #fff;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      }

      body.light-mode .viewport-header {
        background: #d7d7d7;
        border-bottom-color: #dfdfdf;
      }

      body.light-mode .device-size {
        color: #666;
      }

      body.light-mode .devtools-btn {
        color: #666;
      }

      body.light-mode .devtools-btn:hover {
        background: #e0e0e0;
        color: #2196F3;
      }

      body.light-mode .devtools-btn.active {
        color: #2196F3;
        background: rgba(33, 150, 243, 0.1);
      }

      body.light-mode .status-bar {
        background: #fafafa;
        border-top-color: #e0e0e0;
        color: #666;
      }

      body.light-mode .theme-toggle {
        color: #666;
      }

      body.light-mode .theme-toggle:hover {
        background: #e0e0e0;
        color: #333;
      }

      body.light-mode .sidebar {
        background: #fafafa;
        border-right-color: #e0e0e0;
      }

      body.light-mode .sidebar-header {
        background: #f0f0f0;
        border-bottom-color: #e0e0e0;
      }

      body.light-mode .sidebar-close {
        color: #666;
      }

      body.light-mode .sidebar-close:hover {
        color: #333;
      }

      body.light-mode .device-item {
        background: #e8e8e8;
      }

      body.light-mode .device-item:hover {
        background: #ddd;
      }

      body.light-mode .device-item.selected {
        background: #2196F3;
        color: white;
      }

      body.light-mode .device-item-size {
        color: #888;
      }

      body.light-mode .preset-dropdown-toggle {
        background: #e8e8e8;
        border-color: #ddd;
        color: #333;
      }

      body.light-mode .preset-dropdown-toggle:hover {
        background: #ddd;
      }

      body.light-mode .preset-dropdown-toggle.open {
        background: #2196F3;
        border-color: #2196F3;
        color: white;
      }

      body.light-mode .preset-dropdown-menu {
        background: #fff;
        border-color: #ddd;
      }

      body.light-mode .preset-dropdown-item {
        border-bottom-color: #e0e0e0;
      }

      body.light-mode .preset-dropdown-item:hover {
        background: #f0f0f0;
      }

      body.light-mode .preset-dropdown-item.active {
        background: #2196F3;
        color: white;
      }

      body.light-mode .advanced-capture-toggle {
        background: #888;
      }

      body.light-mode .advanced-capture-menu {
        background: #fff;
        border-color: #ddd;
      }

      body.light-mode .advanced-capture-item {
        border-bottom-color: #e0e0e0;
      }

      body.light-mode .advanced-capture-item:hover {
        background: #f0f0f0;
      }

      body.light-mode .custom-preset-controls {
        background: #f8f8f8;
        border-bottom-color: #e0e0e0;
      }

      body.light-mode .selected-devices-title {
        color: #666;
      }

      body.light-mode .sidebar-overlay {
        background: rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <!-- Inline SVG sprite for icons -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <defs>
        <!-- Mobile/Phone icon -->
        <symbol id="icon-mobile" viewBox="0 0 24 24">
          <path d="M17 2H7c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM7 4h10v13H7V4zm5 15c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1-.4 1-1 1z"/>
        </symbol>

        <!-- Desktop/Laptop icon -->
        <symbol id="icon-desktop" viewBox="0 0 24 24">
          <path d="M21 2H3c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h7l-2 3v1h8v-1l-2-3h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 13H3V4h18v11z"/>
        </symbol>

        <!-- Apple icon -->
        <symbol id="icon-apple" viewBox="0 0 24 24">
          <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
        </symbol>

        <!-- Android icon -->
        <symbol id="icon-android" viewBox="0 0 24 24">
          <path d="M17.6 9.48l1.84-3.18c.16-.31.04-.69-.26-.85-.29-.15-.65-.06-.83.22l-1.88 3.24c-2.86-1.21-6.08-1.21-8.94 0L5.65 5.67c-.19-.28-.54-.37-.83-.22-.3.16-.42.54-.26.85L6.4 9.48C3.3 11.25 1.28 14.44 1 18h22c-.28-3.56-2.3-6.75-5.4-8.52zM7 15.25c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25S8.25 13.31 8.25 14s-.56 1.25-1.25 1.25zm10 0c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25S18.25 13.31 18.25 14s-.56 1.25-1.25 1.25z"/>
        </symbol>

        <!-- Settings/Gear icon -->
        <symbol id="icon-settings" viewBox="0 0 24 24">
          <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
        </symbol>

        <!-- Record/Circle icon -->
        <symbol id="icon-record" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="8"/>
        </symbol>

        <!-- Camera icon -->
        <symbol id="icon-camera" viewBox="0 0 24 24">
          <path d="M12 15c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3zm0-4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/>
          <path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/>
        </symbol>

        <!-- Video/Play icon -->
        <symbol id="icon-video" viewBox="0 0 24 24">
          <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4zM14 13h-3v3H9v-3H6v-2h3V8h2v3h3v2z"/>
        </symbol>

        <!-- Stop icon -->
        <symbol id="icon-stop" viewBox="0 0 24 24">
          <path d="M6 6h12v12H6z"/>
        </symbol>

        <!-- Close/X icon -->
        <symbol id="icon-close" viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </symbol>

        <!-- Launch/Rocket icon -->
        <symbol id="icon-launch" viewBox="0 0 24 24">
          <path d="M4.5 20.5L6 19l-1.5-1.5L6 16l2.5 2.5L10 17l1.5 1.5L13 17l.5.5 1.5-1.5L17 18l-1.5 1.5L17 21l-1.5 1.5L13 21l-1.5 1.5L10 21l-2.5 2.5L6 22l-1.5-1.5zM12 2l2.09 6.26L20 10l-5.91 1.74L12 18l-2.09-6.26L4 10l5.91-1.74L12 2z"/>
        </symbol>

        <!-- Menu/Hamburger icon -->
        <symbol id="icon-menu" viewBox="0 0 24 24">
          <path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/>
        </symbol>

        <!-- Tools/DevTools icon -->
        <symbol id="icon-tools" viewBox="0 0 24 24">
          <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
        </symbol>

        <!-- Sun icon for light mode -->
        <symbol id="icon-sun" viewBox="0 0 24 24">
          <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>
        </symbol>

        <!-- Moon icon for dark mode -->
        <symbol id="icon-moon" viewBox="0 0 24 24">
          <path d="M17.75 4.09l-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91l-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02 2.19 2.2 5.16 3.16 8.02 2.89z"/>
        </symbol>
      </defs>
    </svg>
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">Device Library</div>
        <button class="sidebar-close" onclick="toggleSidebar()">×</button>
      </div>

      <div class="custom-preset-controls" id="customPresetControls">
        <div class="selected-devices">
          <div class="selected-devices-title">Custom Preset Devices:</div>
          <div class="selected-device-list" id="selectedDeviceList"></div>
        </div>
        <button class="btn" onclick="applyCustomPreset()" style="margin-top: 10px; width: 100%;">Apply Custom Preset</button>
      </div>

      <div class="device-list" id="deviceList">
        <!-- Devices will be populated by JavaScript -->
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Sidebar Toggle Button -->
      <button class="sidebar-toggle" onclick="toggleSidebar()">
        <svg class="icon"><use href="#icon-menu"></use></svg>
      </button>

      <div class="header">
        <div class="url-bar">
          <div style="position: relative; flex: 1; display: flex;">
            <input type="text" class="url-input" id="urlInput" placeholder="Enter URL..." value="https://example.com">
            <button class="btn" id="historyBtn" onclick="toggleHistory()" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); padding: 4px 8px; font-size: 12px;">▼</button>
            <div class="url-history" id="urlHistory" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: #2a2a2a; border: 1px solid #444; border-radius: 8px; margin-top: 2px; z-index: 1000; max-height: 200px; overflow-y: auto;">
            </div>
          </div>
          <button class="btn" onclick="loadURL()">Go</button>
          <button class="btn" onclick="reloadAll()">⟳</button>
        </div>

        <div class="preset-dropdown">
          <div class="preset-dropdown-toggle" onclick="togglePresetDropdown()">
            <span id="currentPresetName">Responsive</span>
            <span class="preset-dropdown-arrow">▼</span>
          </div>
          <div class="preset-dropdown-menu" id="presetDropdownMenu">
            <div class="preset-dropdown-item" onclick="selectPreset('responsive')">
              <svg class="icon"><use href="#icon-mobile"></use></svg>
              <span>Responsive</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('mobile')">
              <svg class="icon"><use href="#icon-mobile"></use></svg>
              <span>Mobile</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('tablet')">
              <svg class="icon"><use href="#icon-mobile"></use></svg>
              <span>Tablet</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('desktop')">
              <svg class="icon"><use href="#icon-desktop"></use></svg>
              <span>Desktop</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('app-store')">
              <svg class="icon"><use href="#icon-apple"></use></svg>
              <span>App Store</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('app-store-hd')">
              <svg class="icon"><use href="#icon-apple"></use></svg>
              <span>App Store HD</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('play-store')">
              <svg class="icon"><use href="#icon-android"></use></svg>
              <span>Play Store</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('play-store-hd')">
              <svg class="icon"><use href="#icon-android"></use></svg>
              <span>Play Store HD</span>
            </div>
            <div class="preset-dropdown-item" onclick="selectPreset('custom')">
              <svg class="icon"><use href="#icon-settings"></use></svg>
              <span>Custom</span>
            </div>
          </div>
        </div>
      </div>

      <div class="toolbar">
      <div class="sync-controls">
        <label class="sync-option active" id="syncScroll">
          <input type="checkbox" checked> Sync Scroll
      </label>
        <label class="sync-option active" id="syncNavigation">
          <input type="checkbox" checked> Sync Navigation
      </label>
        <label class="sync-option active" id="syncClick">
          <input type="checkbox" checked> Sync Clicks
      </label>
        <label class="sync-option" id="syncHover">
          <input type="checkbox"> Sync Hover
      </label>
        <label class="sync-option" id="syncInput">
          <input type="checkbox"> Sync Input
      </label>

      </div>

      <div class="screenshot-controls">
        <!-- Default visible buttons -->
        <button class="btn" id="manualModeBtn" onclick="openManualMode()" style="background: #4CAF50;">
          <svg class="icon"><use href="#icon-launch"></use></svg>Manual Capture
        </button>
        <button class="btn" id="screenshotAllBtn" onclick="screenshotAll()">
          <svg class="icon"><use href="#icon-camera"></use></svg>Capture All
        </button>

        <!-- Advanced Capture dropdown -->
        <div class="advanced-capture-dropdown">
          <button class="advanced-capture-toggle" onclick="toggleAdvancedCapture()">
            <span>Advanced Capture</span>
            <span class="dropdown-arrow">▼</span>
          </button>
          <div class="advanced-capture-menu" id="advancedCaptureMenu">
            <button class="advanced-capture-item" id="advancedRecordBtn" onclick="startRecording()">
              <svg class="icon"><use href="#icon-record"></use></svg>Start Recording
            </button>
          </div>
        </div>

        <!-- Mode-specific buttons (hidden by default) -->
        <button class="btn hidden" id="triggerScreenshotBtn" onclick="triggerRemoteScreenshot()" style="background: #2196F3;">
          <svg class="icon"><use href="#icon-camera"></use></svg>Take Screenshots Now
        </button>
        <button class="btn hidden" id="stopBtn" onclick="stopRecording()" style="background: #666;">
          <svg class="icon"><use href="#icon-stop"></use></svg>Stop Recording
        </button>
        <button class="btn hidden" id="screenshotWithReplayBtn" onclick="screenshotAllWithReplay()" style="background: #ff8800;">
          <svg class="icon"><use href="#icon-video"></use></svg>Screenshot with Replay
        </button>
        <button class="btn cancel-btn hidden" id="cancelBtn" onclick="cancelMode()">
          <svg class="icon"><use href="#icon-close"></use></svg>Cancel
        </button>
      </div>
    </div>

      <div class="viewports-container" id="viewportsContainer"></div>

      <div class="status-bar">
        <span id="deviceCount">3 devices</span>
        <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle theme">
          <svg class="icon"><use href="#icon-moon"></use></svg>
        </button>
      </div>

      <div class="debug-info" id="debugInfo"></div>
    </div>

    <script src="renderer.js"></script>
    <script>
      // Theme toggle functionality
      function toggleTheme() {
        const body = document.body;
        const themeToggle = document.getElementById('themeToggle');
        const icon = themeToggle.querySelector('use');

        if (body.classList.contains('light-mode')) {
          // Switch to dark mode
          body.classList.remove('light-mode');
          icon.setAttribute('href', '#icon-moon');
          localStorage.setItem('theme', 'dark');
        } else {
          // Switch to light mode
          body.classList.add('light-mode');
          icon.setAttribute('href', '#icon-sun');
          localStorage.setItem('theme', 'light');
        }
      }

      // Load saved theme on startup
      document.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('theme');
        const themeToggle = document.getElementById('themeToggle');
        const icon = themeToggle.querySelector('use');

        if (savedTheme === 'light') {
          document.body.classList.add('light-mode');
          icon.setAttribute('href', '#icon-sun');
        }
      });

      // Debug helper
      function toggleDebug() {
        const debugInfo = document.getElementById('debugInfo');
        debugInfo
          .classList
          .toggle('active');

        if (debugInfo.classList.contains('active')) {
          setInterval(() => {
            const webviews = document.querySelectorAll('webview');
            let info = `Webviews: ${webviews.length}\n`;
            webviews.forEach((wv, i) => {
              const rect = wv.getBoundingClientRect();
              info += `WV${i}: ${rect.width}x${rect.height}\n`;
            });
            debugInfo.textContent = info;
          }, 1000);
        }
      }
    </script>
  </body>
</html>
